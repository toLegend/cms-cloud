package com.cms.cmssetting.filter;import com.cms.cmssetting.util.ResultUtil;import lombok.extern.slf4j.Slf4j;import org.springframework.security.access.AccessDeniedException;import org.springframework.security.oauth2.provider.error.OAuth2AccessDeniedHandler;import org.springframework.stereotype.Component;import javax.servlet.ServletException;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;import java.time.LocalDateTime;import java.util.HashMap;import java.util.Map;/** * 拒绝访问返回封装 * @author momf * @date 2018-10-17 */@Slf4j@Componentpublic class CustomAccessDeniedHandler extends OAuth2AccessDeniedHandler {    @Override    public void handle(HttpServletRequest request, HttpServletResponse httpServletResponse, AccessDeniedException accessDeniedException) throws IOException, ServletException {        httpServletResponse.setContentType("application/json;charset=UTF-8");        Map map = new HashMap(16);        map.put("error", "500");        map.put("message", accessDeniedException.getMessage());        map.put("path", request.getServletPath());        map.put("timestamp", String.valueOf(LocalDateTime.now()));        httpServletResponse.setContentType("application/json");        httpServletResponse.setStatus(HttpServletResponse.SC_UNAUTHORIZED);        ResultUtil.writeJavaScript(httpServletResponse,map);    }}